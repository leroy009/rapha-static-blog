---
import Layout from "../layouts/Layout.astro";
import SearchForm from "../components/SearchForm.astro";
import MostRecentArticle from "../components/MostRecentArticle.astro";
import { HOMEPAGE_ARTICLE_LIMIT } from "../data/constants";

import { getCollection, type CollectionEntry } from "astro:content";
import ArticleCard from "../components/ArticleCard.astro";

const allBlogPosts: CollectionEntry<"blog">[] = (
	await await getCollection("blog")
).sort(
	(a: CollectionEntry<"blog">, b: CollectionEntry<"blog">) =>
		b.data.publishedDate.valueOf() - a.data.publishedDate.valueOf(),
);

const latestArticle: CollectionEntry<"blog"> = allBlogPosts[0];

const remainingArticles: CollectionEntry<"blog">[] = allBlogPosts.slice(1);
---

<Layout title="Rapha Wellness Clinic">
	<!-- Top Grid -->
	<div class="grid grid-cols-1 gap-5 lg:grid-cols-2">
		<div>
			<h1 class="text-5xl font-bold mt-4 mb-8 leading-tight xl:text-6xl">
				Rapha Wellness Clinic
			</h1>

			<SearchForm />
		</div>
		<!-- Most Recent Article -->
		<MostRecentArticle article={latestArticle} />
	</div>

	<!-- Main Grid -->
	<div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
		{
			remainingArticles
				.slice(0, HOMEPAGE_ARTICLE_LIMIT)
				.map((article) => <ArticleCard article={article} />)
		}
	</div>
</Layout>
